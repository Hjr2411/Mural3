<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>MuralSys • Portal de Colaboradores</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="stylesheet" href="style.css" />
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">

  <!-- (opcional) PWA preparado -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
  <!-- ===== LOGIN (visível) ===== -->
  <div id="login-screen" class="screen screen--center">
    <div class="card card--auth" role="dialog" aria-labelledby="login-title">
      <div class="card__header">
        <h1 id="login-title" class="app-title">
          <i class="fa-solid fa-users"></i> Portal de Colaboradores
        </h1>
        <p class="muted">Acesse com seu usuário e senha</p>
      </div>

      <form id="login-form" class="form form--stack" autocomplete="off">
        <label class="field">
          <span class="field__label">Usuário</span>
          <input id="login-username" name="username" type="text" required placeholder="ex.: joao.silva">
        </label>

        <label class="field">
          <span class="field__label">Senha</span>
          <input id="login-password" name="password" type="password" required placeholder="••••••••">
        </label>

        <button type="submit" class="btn btn--primary">
          <i class="fa-solid fa-right-to-bracket"></i> Entrar
        </button>

        <div id="login-error" class="alert alert--error" hidden></div>
      </form>
    </div>
  </div>

  <!-- ===== APP (oculto inicialmente) ===== -->
  <div id="app" class="app" hidden>
    <header class="app-header">
      <div class="app-header__inner">
        <div class="brand">
          <i class="fa-solid fa-users"></i>
          <span class="brand__name">Portal de Colaboradores</span>
        </div>

        <nav class="app-actions">
          <button id="open-composer" class="btn btn--ghost" data-visible-for="admin" title="Novo post" hidden>
            <i class="fa-solid fa-square-plus"></i> Novo post
          </button>

          <div class="user-chip">
            <span id="current-username" class="user-chip__name">—</span>
            <span id="current-role" class="badge">—</span>
          </div>

          <button id="logout-btn" class="btn btn--secondary">
            <i class="fa-solid fa-arrow-right-from-bracket"></i> Sair
          </button>
        </nav>
      </div>
    </header>

    <main class="feed" role="main" aria-live="polite">
      <div class="feed__container">
        <div id="feed-list" class="feed-list" aria-busy="true"></div>
        <div id="feed-empty" class="empty" hidden>
          <i class="fa-regular fa-face-smile"></i>
          <p>Sem publicações por enquanto.</p>
        </div>
      </div>
    </main>
  </div>

  <!-- ===== MODAL COMPOSER (oculto) ===== -->
  <div id="composer-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="composer-title" hidden>
    <div class="modal__dialog">
      <header class="modal__header">
        <h2 id="composer-title"><i class="fa-solid fa-square-plus"></i> Criar/Editar Post</h2>
        <button class="icon-btn modal__close" data-close-modal aria-label="Fechar">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </header>

      <form id="composer-form" class="modal__body form form--stack">
        <div class="grid grid--2">
          <label class="field">
            <span class="field__label">Título</span>
            <input id="post-title" name="titulo" type="text" required placeholder="Ex.: Comunicado importante">
          </label>

          <label class="field">
            <span class="field__label">Ordem no feed</span>
            <input id="post-ordem" name="ordem" type="number" min="1" step="1" value="1" required>
          </label>
        </div>

        <fieldset class="field">
          <legend class="field__label">Tipo do post</legend>
          <div class="segmented">
            <label class="segmented__item">
              <input type="radio" name="tipo" value="texto" checked> Texto
            </label>
            <label class="segmented__item">
              <input type="radio" name="tipo" value="imagem"> Imagem (URL)
            </label>
            <label class="segmented__item">
              <input type="radio" name="tipo" value="enquete"> Enquete
            </label>
          </div>
        </fieldset>

        <!-- TEXTO -->
        <section id="composer-texto" class="composer-section">
          <label class="field">
            <span class="field__label">Conteúdo</span>
            <textarea id="post-conteudo-texto" name="conteudo_texto" rows="5" placeholder="Escreva o comunicado..."></textarea>
          </label>
        </section>

        <!-- IMAGEM (URL no MVP) -->
        <section id="composer-imagem" class="composer-section" hidden>
          <label class="field">
            <span class="field__label">URL da imagem</span>
            <input id="post-conteudo-imagem" name="conteudo_imagem" type="url" placeholder="https://...">
          </label>
          <p class="muted">No MVP não haverá upload; apenas URL de imagem.</p>
        </section>

        <!-- ENQUETE -->
        <section id="composer-enquete" class="composer-section" hidden>
          <div class="grid grid--2">
            <label class="field">
              <span class="field__label">Opção 1</span>
              <input name="enquete_opcao_1" type="text" placeholder="Ex.: 10/10">
            </label>
            <label class="field">
              <span class="field__label">Opção 2</span>
              <input name="enquete_opcao_2" type="text" placeholder="Ex.: 15/10">
            </label>
          </div>
          <div class="grid grid--3">
            <label class="field">
              <span class="field__label">Opção 3 (opcional)</span>
              <input name="enquete_opcao_3" type="text">
            </label>
            <label class="field">
              <span class="field__label">Opção 4 (opcional)</span>
              <input name="enquete_opcao_4" type="text">
            </label>
            <label class="field">
              <span class="field__label">Opção 5 (opcional)</span>
              <input name="enquete_opcao_5" type="text">
            </label>
          </div>
          <p class="muted">Mínimo 2 opções, máximo 5.</p>
        </section>

        <footer class="modal__footer">
          <button type="button" class="btn btn--ghost" data-close-modal>Cancelar</button>
          <button type="submit" class="btn btn--primary">
            <i class="fa-solid fa-paper-plane"></i> Publicar
          </button>
        </footer>
      </form>
    </div>
  </div>

  <!-- TEMPLATE DE POST -->
  <template id="post-card-template">
    <article class="post-card" data-post-id="">
      <header class="post-card__header">
        <div class="post-author">
          <div class="avatar" aria-hidden="true"><i class="fa-solid fa-user"></i></div>
          <div class="author-meta">
            <strong class="author-name">admin</strong>
            <time class="post-time" datetime="">—</time>
          </div>
        </div>

        <div class="post-menu" data-visible-for="admin" hidden>
          <button class="icon-btn post-edit" title="Editar"><i class="fa-solid fa-pen"></i></button>
          <button class="icon-btn post-delete" title="Excluir"><i class="fa-solid fa-trash"></i></button>
        </div>
      </header>

      <h3 class="post-title"></h3>

      <div class="post-content">
        <div class="post-text" hidden></div>

        <figure class="post-image" hidden>
          <img src="" alt="Imagem do post" loading="lazy">
        </figure>

        <form class="post-poll" hidden>
          <fieldset class="poll-options"></fieldset>
          <button type="submit" class="btn btn--primary btn--sm poll-vote">
            <i class="fa-regular fa-square-check"></i> Votar
          </button>
          <div class="poll-results" hidden></div>
        </form>
      </div>

      <div class="post-actions">
        <button class="btn btn--ghost btn-like" aria-pressed="false">
          <i class="fa-regular fa-thumbs-up"></i> <span>Like</span>
          <span class="like-count badge badge--muted">0</span>
        </button>
      </div>

      <section class="post-comments">
        <ul class="comment-list" role="list"></ul>
        <form class="comment-form" autocomplete="off">
          <label class="sr-only" for="comment-input">Adicionar comentário</label>
          <input class="comment-input" name="comment" type="text" placeholder="Escreva um comentário/solicitação…" required>
          <button class="btn btn--secondary btn--sm" type="submit">
            <i class="fa-solid fa-paper-plane"></i> Enviar
          </button>
        </form>
      </section>
    </article>
  </template>

  <dialog id="confirm-dialog" class="dialog">
    <form method="dialog" class="dialog__body">
      <p id="confirm-text">Tem certeza?</p>
      <menu class="dialog__actions">
        <button value="cancel" class="btn btn--ghost">Cancelar</button>
        <button value="ok" class="btn btn--danger">Excluir</button>
      </menu>
    </form>
  </dialog>

  <div id="toast" class="toast" role="status" aria-live="polite" hidden></div>

  <!-- IMPORTANTE: module -->
  <script type="module" src="app.js"></script>
</body>
</html>
